document.addEventListener("DOMContentLoaded",(async function(){const id=localStorage.getItem("id")||387862;const container=document.getElementById("full");container.innerHTML=`\n        <div class="text-center my-5">\n            <div class="spinner-border text-primary" role="status">\n                <span class="visually-hidden">Loading...</span>\n            </div>\n            <p class="mt-2">Loading news article...</p>\n        </div>\n    `;try{const data=await fetchNewsData(id);console.log(data);displayNewsItem(data);document.title=`${data.title.rendered} | Nkhani pa Malawi`}catch(error){console.error("Error loading news:",error);showErrorState()}async function fetchNewsData(id){const response=await fetch(`https://mwnation.com/wp-json/wp/v2/posts/${id}`,{method:"GET"});return await response.json()}function displayNewsItem(data){container.innerHTML="";const article=document.createElement("article");article.className="news-article mb-5";const title=document.createElement("h1");title.className="article-title text-uppercase bold mb-3";title.textContent=data.title.rendered;const date=document.createElement("div");date.className="article-date text-muted mb-3";const dateObj=new Date(data.date);date.textContent=dateObj.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});let featuredImage=null;if(data.featured_media&&data.yoast_head_json?.og_image?.[0]?.url){featuredImage=document.createElement("img");featuredImage.className="img-fluid rounded mb-4";featuredImage.src=data.yoast_head_json.og_image[0].url;featuredImage.alt=data.title.rendered;featuredImage.loading="lazy"}const content=document.createElement("div");content.className="article-content";content.innerHTML=sanitizeContent(data.content.rendered);const source=document.createElement("div");source.className="article-source mt-4 text-end text-muted";source.textContent=`Source: ${data.yoast_head_json?.author||"Unknown"}`;const shareButtons=createShareButtons(data.title.rendered,window.location.href);article.appendChild(title);article.appendChild(date);if(featuredImage)article.appendChild(featuredImage);article.appendChild(content);article.appendChild(shareButtons);article.appendChild(source);container.appendChild(article);formatContentElements(content)}function showErrorState(){container.innerHTML=`\n            <div class="alert alert-danger my-5">\n                <h4>Error Loading Content</h4>\n                <p>We couldn't load the news article. Please try again later.</p>\n                <button class="btn btn-primary mt-2" onclick="window.location.reload()">\n                    Reload Page\n                </button>\n            </div>\n        `}function sanitizeContent(html){return html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")}function formatContentElements(content){const paragraphs=content.querySelectorAll("p");paragraphs.forEach((p=>{p.classList.add("mb-3","text-justify")}));const images=content.querySelectorAll("img");images.forEach((img=>{img.classList.add("img-fluid","rounded","my-3","d-block","mx-auto");img.loading="lazy";if(!img.alt)img.alt="News content image"}));const headings=content.querySelectorAll("h2, h3, h4");headings.forEach((heading=>{heading.classList.add("mt-4","mb-3")}))}function createShareButtons(title,url){const shareContainer=document.createElement("div");shareContainer.className="share-buttons d-flex justify-content-center gap-3 my-4";const encodedTitle=encodeURIComponent(title);const encodedUrl=encodeURIComponent(url);shareContainer.innerHTML=`\n            <a href="https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}" \n               target="_blank" class="btn btn-outline-primary">\n                <i class="bi bi-facebook"></i> Share\n            </a>\n            <a href="https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}" \n               target="_blank" class="btn btn-outline-info">\n                <i class="bi bi-twitter"></i> Tweet\n            </a>\n            <a href="whatsapp://send?text=${encodedTitle} - ${encodedUrl}" \n               target="_blank" class="btn btn-outline-success">\n                <i class="bi bi-whatsapp"></i> WhatsApp\n            </a>\n        `;return shareContainer}}));